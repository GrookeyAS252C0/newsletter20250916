# メルマガ「一日一知」生成システム

日本大学第一中学・高等学校向けメールマガジン自動生成アプリケーション

## 🚀 クイックスタート

### 推奨起動方法
```bash
streamlit run app.py
```

統一エントリーポイントから新バージョン・レガシー版を選択できます。

### 個別起動方法

#### 新バージョン（推奨）
```bash
streamlit run streamlit_app.py
```

#### レガシー版
```bash
streamlit run legacy_app.py
```

## ✨ 主な機能

### 📸 お天気スクリーンショット解析
- 天気予報のスクリーンショットをアップロード
- OpenAI Vision APIで自動解析
- API取得との自動フォールバック

### 📅 Google Calendar連携
- 学校行事カレンダーから自動取得
- 広報イベント情報の統合

### 💎 教育名言システム
- 52件の教育名言データベース
- LLM活用の文脈解釈
- 重複防止機能

### 🌙 月齢・天体情報
- 高精度月齢計算
- カウントダウン機能

## 📂 アプリ構成

```
├── app.py                    # 統一エントリーポイント（推奨）
├── streamlit_app.py          # 新バージョン
├── legacy_app.py            # レガシー版
├── ui.py                    # レガシーUI
├── src/                     # 新バージョン構造
│   ├── ui/                  # UI コントローラー
│   ├── core/                # 設定管理
│   └── utils/               # ユーティリティ
└── [その他のサービスファイル]
```

## ⚙️ 環境設定

### 必須環境変数 (.env)
```env
OPENAI_API_KEY=your_openai_api_key_here
YOUTUBE_API_KEY=your_youtube_api_key_here  # オプション
```

### 必須パッケージ
```bash
pip install streamlit openai jinja2 requests python-dotenv
```

### オプションパッケージ
```bash
pip install pyperclip google-api-python-client
```

## 🔧 トラブルシューティング

### よくある問題

1. **型ヒントエラー**
   - Python 3.8+ を使用してください
   - 型ヒントは修正済みです

2. **インポートエラー**
   - パッケージがインストールされていることを確認
   - 仮想環境が正しくアクティブ化されていることを確認

3. **ファイルアップロードができない**
   - ブラウザのキャッシュをクリア
   - ファイルサイズが20MB以下であることを確認

### デバッグモード
```bash
DEBUG_MODE=true streamlit run app.py
```

## 📱 使用方法

1. **アプリ起動**: `streamlit run app.py`
2. **バージョン選択**: サイドバーで新バージョン/レガシー版を選択
3. **天気情報**: スクリーンショットをアップロード（オプション）
4. **日付設定**: メルマガ発行日を選択
5. **生成実行**: 「メルマガを生成」ボタンをクリック

## 🎯 機能の違い

| 機能 | 新バージョン | レガシー版 |
|------|-------------|------------|
| UI構造 | モジュール化 | シンプル |
| エラーハンドリング | 高度 | 基本 |
| キャッシュ機能 | あり | なし |
| ログ機能 | 統一システム | 基本 |
| 月齢計算 | 高精度 | 標準 |

## 🔄 更新履歴

- **v1.3.0**: スクリーンショット天気解析機能追加
- **v1.2.0**: 新バージョンUI構造実装
- **v1.1.0**: 名言システム統合
- **v1.0.0**: 基本機能実装

---

**開発**: Claude Code
**更新**: 2025年9月18日